server {
  listen 80;
  server_name _;

  # Proxy headers
  proxy_set_header Host $host;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header X-Forwarded-Proto $scheme;

  # API under /api -> server container
  location /api/ {
    proxy_pass http://raworc_api:9000;
  }
  location = /api { return 301 /api/; }

  # Public content under /content -> content container
  location /content/ {
    proxy_pass http://raworc_content:8000;
  }
  location = /content { return 301 /content/; }

  # Root -> Operator UI (operator container on :7000)
  location / {
    proxy_pass http://raworc_operator:7000;
  }
}
